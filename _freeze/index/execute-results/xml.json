{
  "hash": "18e0aa6a9bf2f53dd960fb6be1113bf6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Pre-Columbian forest gardens span 180 km² in Bolivia's Iténez preserve\nauthors:\n  - name: Nicolas Gauthier\n    affiliation: Florida Museum of Natural History, University of Florida\n    roles: writing\n    orcid: 0000-0002-2225-5827\n    corresponding: true\nbibliography: references.bib\nabstract: |\n  The Iténez Forest Preserve in the Bolivian Amazon spans 4,000 km² between two of South America's most significant archaeological landscapes—yet until now it remained unmapped, a blank spot between lowland Bolivia and the Brazilian Amazon. Using satellite imagery from the driest months on record and an AI-assisted detection system, I identified 180 km² of anthropogenic soils and forest gardens across the preserve. These features, connected by dense networks of earthworks that remain to be fully mapped, reveal organized landscape modification on a scale comparable to the region's famous earthwork complexes. The findings demonstrate how ancient peoples transformed rainforest into productive cultural landscapes whose ecological signatures persist today, with local communities continuing to harvest cacao and other useful species from these anthropogenic forests. This work illustrates how AI can support—but not replace—human expertise in archaeological detection at regional scales.\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nhere() starts at /Users/nick/UFL Dropbox/Nicolas Gauthier/Projects/openai-to-z\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(yardstick)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'yardstick'\n\nThe following object is masked from 'package:readr':\n\n    spec\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLinking to GEOS 3.13.1, GDAL 3.11.0, PROJ 9.6.0; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(mapview)\nlibrary(maptiles)\nlibrary(tidyterra)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'tidyterra'\n\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nsource(here('R/moondream.R'))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'jsonlite'\n\nThe following object is masked from 'package:purrr':\n\n    flatten\n\nLinking to: OpenSSL 3.3.2 3 Sep 2024\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(patchwork)\nplot_nth_set_gg <- function(lst, n, nrow = 1, ncol = 3) {\n  # Get the nth list item\n  if (length(lst) < n) {\n    stop(\"List doesn't have \", n, \" items\")\n  }\n  \n  images <- lst[[n]]\n  \n  plots <- map(images, ~ {\n    img <- magick::image_read(.x)\n    ggplot() +\n      annotation_raster(as.raster(img), -Inf, Inf, -Inf, Inf) +\n      theme_void() +\n      coord_equal()\n  })\n  \n  wrap_plots(plots, nrow = nrow, ncol = ncol)\n}\nget_sorted_files <- function(pattern, dir = here('data/derived/tile_768')) {\n  list.files(dir, recursive = TRUE, pattern = pattern, full.names = TRUE) |>\n    gtools::mixedsort()\n}\n\ncreate_image_triplets <- function() {\n  img_paths <- c('geology', 'moisture', 'canopy') |>\n    paste0('_chip.jpg') |>\n    map(get_sorted_files)\n\n  # Create list of triplets\n  n_images <- length(img_paths[[1]])\n  map(1:n_images, ~list(\n    c1 = img_paths[[1]][.x],\n    c2 = img_paths[[2]][.x],\n    chm = img_paths[[3]][.x]\n  ))\n}\n\ntriplets <- create_image_triplets()\ntiles <- readRDS(here('data/derived/tiles_768_sf.rds'))\n```\n:::\n\n\n\n\n\n## Introduction\n\nFor decades, a 4,000 km² void has persisted in archaeological maps of the Amazon, separating the well-studied earthwork landscapes of Bolivia from the forests of the Brazilian Amazon. The Iténez Forest Preserve occupies this glaring gap along the Bolivia-Brazil border. Located along the Bolivia-Brazil border between the extensively studied earthwork landscapes of the Bolivian lowlands and the forests of the Brazilian Amazon, this 4,000 km² expanse of forest remained largely unmapped by archaeologists. While important studies have documented sites at the preserve's northern and southern margins [@robinson2021; @prümers2023; @carson2016pre] , the rugged interior—the vast majority of this territory—has remained archaeologically unknown. Dense canopy cover, remoteness, and lack of prior survey work in the interior left it a blank spot on regional maps—a void in our understanding of southwestern Amazonian prehistory. Its position between known centers of pre-Columbian engineering [@peripato2023; @desouza2018], however, suggested it might hold similar evidence of ancient landscape modification.\n\nThis study fills that gap through systematic remote sensing analysis, revealing extensive anthropogenic landscapes hidden beneath the forest canopy. The work focuses specifically on detecting Amazonian Dark Earth (ADE) and associated forest gardens—patches of modified forest composition that mark ancient settlements and agricultural areas [@schmidt2014; @palace2017; @goldberg2024] . While earthworks are noted where visible, comprehensive mapping of these features beneath the canopy remains for future work. This approach prioritizes the detection of anthropogenic soils and forest composition changes that represent the primary evidence of human landscape transformation in continuously forested regions.\n\n![Sentinel-2 false color image composite of Itenez Forest Preserve from summer 2023. Light red spots indicate drier , lowcanopy vegetation associated with anthropogenic forest gardens (palms, cacao, bamboo, and other economically useful plants).](images/clipboard-2087942158.jpeg)\n\nThe detection of these features at regional scale required developing new methodological approaches that combine AI-assisted pattern recognition with expert archaeological interpretation—a partnership where computational tools support but do not replace human expertise in identifying and mapping cultural landscapes.\n\n## Methods\n\n### Image Selection and Processing\n\nI selected Sentinel-2 imagery [@copernicus_s2_sr_harmonized] from the driest periods in the satellite record (late summer 2023 and 2024), when reduced vegetation moisture and seasonal leaf loss maximize visibility of underlying soil and vegetation patterns. Cloud-free mosaics were processed in Google Earth Engine, combined with a state of the art regional canopy height model [@wagner2025highresolutiontreeheight] to distinguish anthropogenic forest structures from natural variation.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_nth_set_gg(triplets, 58)\n```\n\n::: {.cell-output-display}\n![False color Sentinel 2 image chips (left, center) and canopy height estimate (right). Anthropogenic forest patches appears as rounded patches of dry, low-canopy vegetation along terraces. Faint traces of earthworks and ditches can be seen surrounding and connecting the forest patches.](index_files/figure-jats/unnamed-chunk-1-1.png)\n:::\n:::\n\n\n\n\n\nThe imagery was exported as multi-scale tiles (512, 768, and 1024 pixels) with band combinations optimized to highlight spectral signatures of ADE and modified forest. These signatures reflect the distinct ecological characteristics of anthropogenic landscapes: more open canopy structure, seasonal deciduousness, high concentrations of useful plants (palms, bamboos, cacao), and altered soil chemistry from centuries of human occupation and management [@heckenberger2008, @palace2017, @robinson2021].\n\n![Detail of transition between natural forest vegetation (left) and anthropogenic forest (right). Not the lighter vegetation, lower canopy, and preponderance of palms and lianas.](images/clipboard-593555342.png)\n\n### Detection Workflow: Human-AI Partnership\n\nI developed an agentic object detection system using GPT-4.1, and Moondream2 vision-language models to identify anthropogenic features at scale. This system serves as a detection and verification tool, supporting human expertise rather than replacing it. The workflow operates as follows:\n\n1.  GPT models review imagery and generate initial hypotheses about feature locations based on spectral patterns and landscape context. They are prompted to view the landscape holistically, looking for patterns across multiple domains, rather than focusing on strict quantitative criteria.\n2.  The primary models iteratively refine predictions through successive passes using a smaller, specialized vision language models tuned for object detection and grounding. These system lack the domain knowledge of the image contents, so the GPT agent must generate creative, abstract text prompts to detect all features in the scene (e.g. \"reddish-pink spots\", \"purple swirls\".\n3.  The system produces point predictions marking potential anthropogenic sites\n4.  These points guide large-scale verification and exploration of spatial patterns\n\n**Examples:**\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_nth_set_gg(triplets, 59)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-2-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nagent_test1 <- detect_anthrosols(triplets[[59]], mode = 'gpt-4.1', echo = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Scene interpretation (Step 1):**\n\n- **C1:** The scene is dominated by a continuous, mottled forest matrix. There \nare several compact, bright reddish-pink/magenta patches, especially in the \nlower left, lower center, and upper center-left. These patches are not simply \nat the forest edge or in open areas, but embedded within the forest, and some \nhave lobate or elliptical forms. \n- **C2:** These same areas correspond to bright yellow/orange splotches, \nsupporting the interpretation of stressed/drier vegetation typical of ADE \npatches. The yellow/orange is compact and not overly diffuse.\n- **CHM:** The compact reddish-pink patches in C1 correspond to areas of lower \ncanopy height (darker blue/purple zones), sometimes with a ring or edge effect,\nconsistent with ADE patch structure.\n\n**Spatial context:** The anomalies are within a continuous forest, not at the \nforest-nonforest boundary, and are not simply isolated forest islands. Some are\nnear the edge of a bluff or drainage, which fits expected ADE patch placement.\n\n**Initial expert estimate:** There are at least 3–4 compact, plausible ADE-like\npatches in this scene, possibly up to 5 if smaller lobate forms are included.\n\n**Proceeding to Moondream object detection (Step 2).**\n\n**First two prompts:**\n- \"reddish-pink spots\"\n- \"magenta patches\"\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n◯ [tool call] tool_001(prompt = \"reddish-pink spots\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n● #> [{\"x\":0.0918,\"y\":0.2998},{\"x\":0.292,\"y\":0.8223},{\"x\":0.4375,\"y\":0.7656},{…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n◯ [tool call] tool_001(prompt = \"magenta patches\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n● #> [{\"x\":0.4404,\"y\":0.7637},{\"x\":0.2949,\"y\":0.8213},{\"x\":0.0918,\"y\":0.2998},…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Synthesis of Moondream points (Step 3):**\n\n- Both prompts (\"reddish-pink spots\", \"magenta patches\") returned highly \noverlapping sets of points, indicating robust detection of the main anomalies.\n- After removing duplicates, the following distinct compact patch locations are\nidentified:\n  1. (0.0918, 0.2998) — Lower left, compact, strong dual spectral support, low \nCHM\n  2. (0.292, 0.8223) — Lower center, compact, strong dual spectral support, low\nCHM\n  3. (0.4375, 0.7656) — Lower center-right, compact, strong dual spectral \nsupport, low CHM\n  4. (0.6309, 0.5967) — Central, compact, strong dual spectral support, low CHM\n  5. (0.7344, 0.1084) — Upper right, compact, strong dual spectral support, low\nCHM\n  6. (0.8486, 0.3789) — Right-central, compact, strong dual spectral support, \nlow CHM\n\n- The point at (0.9678, 0.6709) is near the extreme right edge and may be \npartially outside the main forest matrix, but still fits the context.\n- All selected points are ≥5 ha, compact, and have supporting \nspectral/structural context.\n\n**Summary of synthesis:**\n- 6–7 distinct, compact ADE-like patches detected, all with strong dual \nspectral and CHM support.\n- All are embedded in continuous forest, not at forest-nonforest boundaries.\n- Points are robust across both detection prompts.\n- No diffuse or edge-only anomalies included.\n- All fit expected ADE patch form and context.\n\nDONE.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_detections(agent_test1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-4-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_nth_set_gg(triplets, 59)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-5-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nagent_test2 <- detect_anthrosols(triplets[[58]], mode = 'gpt-4.1', echo = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Scene interpretation (Step 1):**\n\n- **C1:** Several compact, bright reddish-pink/magenta patches are visible, \nespecially to the right of the main drainage and near the center-right. These \nare distinct from the surrounding mottled forest matrix and are not simply \nforest-nonforest boundaries. Their form is compact and lobate, not diffuse.\n- **C2:** These same areas correspond to bright yellow/orange splotches, \nsupporting the interpretation of stressed/drier vegetation typical of ADE \npatches.\n- **CHM:** These patches do not correspond to clearings or sharp canopy gaps, \nbut some show subtle lower-canopy signals, consistent with ADE forest \nstructure.\n- **Context:** The anomalies are within continuous forest, not at the edge or \nin floodplain, and are not recent disturbances. Their spatial patterning \n(clustered, not random) and proximity to drainage align with expected ADE \ncontext.\n\n**Initial expert estimate:** 3–5 valid ADE-like patches (mainly in the right \nhalf of the image).\n\nProceeding to Moondream object detection for precise locations.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n◯ [tool call] tool_002(prompt = \"reddish-pink spots\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n● #> [{\"x\":0.7393,\"y\":0.6631},{\"x\":0.6777,\"y\":0.3467},{\"x\":0.8906,\"y\":0.3037},…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n◯ [tool call] tool_002(prompt = \"magenta patches\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n● #> [{\"x\":0.7412,\"y\":0.6641},{\"x\":0.6777,\"y\":0.3467},{\"x\":0.8916,\"y\":0.2998},…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Synthesis (Step 3):**\n\n- Both tool calls (\"reddish-pink spots\", \"magenta patches\") returned nearly \nidentical sets of points, confirming the robustness of the detections.\n- After removing redundant points (duplicates within a few pixels), there are 5\ndistinct, compact patches that are well supported by both spectral images and \ncontext:\n  1. (0.739, 0.663) — right-central, strong magenta/yellow\n  2. (0.678, 0.347) — upper-right, compact, strong signal\n  3. (0.891, 0.302) — far right, compact, strong signal\n  4. (0.359, 0.546) — left-central, compact, moderate signal\n  5. (0.090, 0.503) — far left, compact, moderate signal\n\n- The remaining points (e.g., at the very bottom or edge) are either redundant \nor less well supported by context and spectral pattern.\n- All selected patches are ≥5 ha, compact, and within continuous forest matrix,\nnot at forest edge or in floodplain.\n\n**Summary:** 5 valid ADE-like patches detected, all with strong dual spectral \nsupport and appropriate context.\n\nDONE.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_detections(agent_test2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-7-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_nth_set_gg(triplets, 59)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-8-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nagent_test3 <- detect_anthrosols(triplets[[50]], mode = 'gpt-4.1', echo = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Scene interpretation (Step 1):**\n\n- **C1:** Several compact, lobate, reddish-pink/magenta patches are visible, \nespecially in the lower and central portions of the image. These patches are \nembedded within a continuous forest matrix, not at the forest-nonforest \nboundary. Their form is compact and clustered, not diffuse.\n- **C2:** The same locations show bright yellow/orange splotches, supporting \nthe interpretation of stressed/drier vegetation consistent with ADE patches.\n- **CHM:** These areas correspond to subtle, compact zones of lower canopy \nheight, sometimes with a ringed or clustered structure, further supporting the \nADE hypothesis.\n\n**Spatial context:** The anomalies are aligned along subtle drainage lines and \nare not simply forest islands or recent clearings. Their size and form are \nconsistent with ADE patches (≥5 ha, compact, not diffuse).\n\n**Initial expert estimate:** There are approximately 7–9 plausible ADE patches \nin this scene, based on the spectral and structural evidence.\n\nProceeding to Moondream object detection for precise point locations.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n◯ [tool call] tool_003(prompt = \"reddish-pink spots\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n● #> [{\"x\":0.4102,\"y\":0.6172},{\"x\":0.4121,\"y\":0.8291},{\"x\":0.5,\"y\":0.9248},{\"x…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n◯ [tool call] tool_003(prompt = \"magenta patches\")\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n● #> [{\"x\":0.4092,\"y\":0.6172},{\"x\":0.4092,\"y\":0.8291},{\"x\":0.5,\"y\":0.9248},{\"x…\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n**Synthesis (Step 3):**\n\n- Both prompts (\"reddish-pink spots\", \"magenta patches\") returned highly \nsimilar sets of points, confirming the robustness of the detection.\n- After removing redundant/overlapping points and excluding those at the \nextreme image edge or lacking compact form/context, the following distinct, \ncompact patches are validated:\n  1. (0.410, 0.617) – central, strong spectral/structural support\n  2. (0.412, 0.829) – lower central, strong support\n  3. (0.500, 0.925) – lower center, strong support\n  4. (0.605, 0.965) – lower right, strong support\n  5. (0.778, 0.710) – right-central, strong support\n  6. (0.834, 0.834) – lower right, strong support\n  7. (0.832, 0.601) – mid-right, strong support\n  8. (0.856, 0.335) – upper right, strong support\n  9. (0.676, 0.336) – upper central, strong support\n  10. (0.412, 0.267) – upper central, strong support\n\n- Points at (0.156, 0.190), (0.028, 0.136), (0.163, 0.190), (0.032, 0.141), and\n(0.781, 0.342), (0.681, 0.333) are either redundant or at the extreme edge with\nless clear context, so are excluded.\n\n**Final synthesis:** 10 distinct, compact ADE patch candidates, all with strong\ndual spectral and structural support, compact form, and plausible context.\n\nDONE.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nplot_detections(agent_test3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-10-1.png)\n:::\n:::\n\n\n\n\n\nCritically, this AI component operated in parallel with detailed manual mapping. I meticulously reviewed and labeled hundreds of polygon boundaries over anthropogenic forest patches through careful imagery analysis, with the AI and manual mapping developing iteratively and informing each other. Earthworks—canals, ditches, and geometric earthworks—were recorded where visible through the canopy, though comprehensive mapping of these linear features remains a priority for future work with higher-resolution imagery. This approach allowed me to iteratively calibrate and validate the models' ability to detect known archaeological features in zero-shot and few-shot learning contexts. The models were not fine-tuned but leveraged pre-trained capabilities to recognize visual patterns consistent with archaeological features. This approach exemplifies how AI can extend human capacity for regional-scale analysis without replacing the expertise necessary for accurate feature identification and interpretation.\n\n## Results\n\nThe analysis **identified approximately 180 km² of anthropogenic soils and forest gardens within the Iténez Forest Preserve, representing 5% of its total area—comparable to the footprint of many modern world cities**, though distributed as a network of patches rather than a contiguous area. I mapped over 350 individual fields ranging from 5 to 700 hectares, with clear spatial clustering along bluffs, drainages, and floodplain margins in upland *terra firme* forest—confirming hypotheses about bluff-edge settlement systems previously proposed for this region [@denevan1996].\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nanthrosols <- read_sf('data/derived/anthrosols.gpkg') |>\n    mutate(area = units::set_units(st_area(geom), km2) |> units::drop_units())\n\nmapview(anthrosols, basemaps = 'Esri.WorldImagery')\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////private/var/folders/pt/mdk8gblx1f30vm94rgg1582r0000gn/T/Rtmp4QjdrZ/filecbed4e898912/widgetcbed27862506.html screenshot completed\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Anthropogenic forest patches.](index_files/figure-jats/unnamed-chunk-11-1.png)\n:::\n\n```{.r .cell-code .hidden}\n# Get tiles automatically based on your data extent\nelev_tiles <- get_tiles(st_bbox(anthrosols) |> st_as_sfc() |> st_buffer(10000), \n                        provider = \"Esri.NatGeoWorldMap\", zoom = 11, verbose = FALSE) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n|---------|---------|---------|---------|\n=========================================\n                                          \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggplot() +\n  geom_spatraster_rgb(data = elev_tiles) +  # basemap\n  geom_sf(data = st_centroid(anthrosols), aes(size = area)) +  \n  scale_size_area(name = 'area (km2)') +\n  coord_sf(crs = st_crs(elev_tiles)) +\n  theme_void()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n<SpatRaster> resampled to 500778 cells.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Anthropogenic forest patches.](index_files/figure-jats/unnamed-chunk-11-2.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nconvert_tile_points <- function(points_tibble, tile_geom) {\n  # Get bounding box of the tile\n  bbox <- st_bbox(tile_geom)\n  # Convert normalized coordinates to spatial coordinates\n  points_tibble %>%\n    mutate(\n      spatial_x = bbox[\"xmin\"] + x * (bbox[\"xmax\"] - bbox[\"xmin\"]),\n      spatial_y = bbox[\"ymin\"] + y * (bbox[\"ymax\"] - bbox[\"ymin\"])\n    )\n}\n\ncombine_all_points <- function(points_list, tiles_list) {\n  # Convert all and add tile index\n  spatial_list <- map2(points_list, tiles_list, convert_tile_points) %>%\n    imap(~ mutate(.x, tile_id = .y))  # Add tile identifier\n  \n  # Combine all tibbles\n  all_points <- bind_rows(spatial_list)\n  \n  # Convert to sf using CRS from first tile\n  all_points %>%\n    st_as_sf(coords = c(\"spatial_x\", \"spatial_y\"), \n             crs =4326)\n}\n\nagent_results <- readRDS(here('data/derived/moon_41.rds'))\n\nagent_points <- map(agent_results, ~.x$result$points) |>\n  combine_all_points(tiles$geom) |>\n  select(-x, -y)\n\nggplot() +\n  geom_spatraster_rgb(data = elev_tiles) +  # basemap\n  geom_sf(data = st_centroid(anthrosols),fill = 'black') +\n  geom_sf(data = agent_points, size = 1, color = 'red') +\n  coord_sf(crs = st_crs(elev_tiles)) +\n  theme_void()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n<SpatRaster> resampled to 500778 cells.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Manually labeled site locations (black) compared to automatically detected locations (red).](index_files/figure-jats/unnamed-chunk-12-1.png)\n:::\n:::\n\n\n\n\n\nThe most striking discovery is a major complex spanning more than 4 kilometers, where large-scale fields connect through networks of earthworks. Across the mapped area, an exceptionally dense system of linear features links settlements into an integrated landscape. While full mapping of these earthworks awaits future work with canopy-penetrating sensors, their visible portions already demonstrate a level of landscape integration comparable to the most complex sites in neighboring regions.\n\n![](images/clipboard-4170918036.jpeg)\n\nRank-size analysis reveals a clear hierarchical structure in field sizes and site distribution, with the size distribution following a power law with an exponent close to 1 on log-log plots. This pattern, consistent with organized settlement systems, matches the scale and complexity documented in the Llanos de Mojos and Baures [@prumers2022lidar; @erickson2000]. The largest sites anchor networks of settlement and agroforestry patches, suggesting centralized planning and resource management across the landscape.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Prepare data for rank size plot\nrank_size_data <- anthrosols %>%\n  arrange(desc(area)) %>%\n  mutate(rank = row_number())\n\n# Add trend line to check for Zipf's law\nggplot(rank_size_data, aes(x = rank, y = area)) +\n  geom_point(size = 3, color = \"red\") +\n  geom_smooth(method = \"lm\", se = TRUE, color = \"black\", linetype = \"dashed\") +\n  scale_x_log10() +\n  scale_y_log10() +\n  labs(title = \"Rank Size Plot with Trend Line\",\n       x = \"Rank (log scale)\",\n       y = \"Area (log scale)\",\n       subtitle = \"Dashed line shows linear fit in log-log space\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-13-1.png)\n:::\n:::\n\n\n\n\n\nThese anthropogenic landscapes remain ecologically distinct today. Forest composition in mapped areas shows high concentrations of economically useful species, particularly cacao, making the region a modern hotspot for wild cacao cultivation—a direct legacy of ancient land use practices [@carson2016pre] . Local and Indigenous communities continue to harvest these resources, underscoring that these are not merely archaeological sites but living landscapes where ancient management practices continue to shape both forest ecology and human livelihoods.\n\n## Discussion\n\nThese findings transform our understanding of the Iténez region from archaeological blank spot to critical piece in the Amazonian puzzle. The extent and organization of anthropogenic landscapes documented here match or exceed those in better-studied areas, confirming that large-scale landscape engineering extended continuously across the southwestern Amazon. This fills the last major gap in the regional archaeological map between the Llanos de Mojos and Baures, revealing that the Iténez was not a periphery but an integral part of pre-Columbian regional systems.\n\nThe hierarchical site structure and extensive earthwork networks point to complex social organization capable of coordinating landscape modification across thousands of square kilometers. Rather than isolated communities practicing small-scale agriculture, the evidence suggests integrated regional systems linking settlements through engineered infrastructure and shared land management practices. The concentration of sites along bluff edges and floodplain margins confirms earlier hypotheses about settlement preferences in *terra firme* forests, while the scale revealed here exceeds previous expectations.\n\nThe ecological legacy of these ancient landscapes extends beyond their archaeological significance. Forest composition in mapped areas reflects centuries of human selection for useful species, creating patches of anthropogenic forest that blur the line between nature and culture. The continued harvesting of cacao and other products from these forests by contemporary communities represents an unbroken tradition of forest management extending from pre-Columbian times to the present. This continuity challenges us to recognize that the \"pristine\" forests we seek to conserve are themselves products of Indigenous innovation and management.\n\nThe successful detection of these features through combined AI and expert analysis demonstrates new possibilities for archaeological survey in forested regions. The human-AI partnership developed here—where computational tools assist in pattern detection while human expertise guides interpretation and mapping—offers a model for scaling archaeological survey across Amazonia's vast forests. This approach proved particularly effective for identifying the subtle spectral signatures of anthropogenic soils and forest gardens that would be impossible to map at this scale through ground survey alone.\n\n### Implications and Future Directions\n\nThis work contributes to the mounting evidence that the Amazon was extensively shaped by its pre-Columbian inhabitants, adding a major piece to our understanding of regional cultural landscapes. The Iténez landscapes join the growing inventory documented by recent synthetic works, while demonstrating that significant discoveries remain to be made even in the 21st century. The findings reinforce emerging models of pre-Columbian Amazonia as a mosaic of engineered landscapes rather than pristine wilderness punctuated by occasional cultural sites.\n\nFuture research should pursue several directions. First, LiDAR or high-resolution radar imagery could reveal the full extent of earthwork networks currently hidden beneath the canopy, allowing comprehensive mapping of the linear features only partially visible in optical imagery. Second, systematic field verification and dating would establish the chronology and cultural affiliations of these landscapes, potentially revealing connections to known archaeological cultures of the Llanos de Mojos and Baures. Third, detailed ecological studies of forest composition and soil properties would deepen our understanding of how ancient management practices created the anthropogenic forests that communities value today. The methodological approach developed here—combining AI-assisted detection with expert archaeological interpretation—offers broader applications for Amazonian archaeology. As we refine these tools, maintaining the balance between computational efficiency and human expertise will be critical. AI can help us see patterns across vast scales, but understanding what those patterns mean for human history requires archaeological knowledge that no algorithm can replace.\n\nThese findings also have immediate relevance for conservation planning. Protecting these forests means protecting both biodiversity and living Indigenous heritage—recognizing that the ecological richness we value today emerged from millennia of human management.\n\n## Conclusion\n\nThe Iténez Forest Preserve emerges from this analysis not as pristine wilderness but as a cultural landscape shaped by centuries of Indigenous management. The 180 km² of mapped anthropogenic soils and forest gardens, connected by dense earthwork networks and organized in hierarchical patterns, demonstrate that pre-Columbian peoples transformed this region as extensively as anywhere in Amazonia. This work fills the last major blank spot in the archaeological map of the southwestern Amazon, revealing continuous cultural landscapes between previously studied regions.\n\nThese findings illustrate both the potential and limits of new technological approaches to archaeology. While AI-assisted detection enabled mapping at unprecedented scales, the interpretation and validation of these features required human expertise at every step. This partnership between computational tools and archaeological knowledge offers a path forward for understanding Amazonia's human past across its vast forested expanses.\n\nAs we continue to reveal the Amazon's deep human history, we gain essential perspective on its present and future. The forest gardens where communities harvest cacao today are living monuments to Indigenous landscape management, reminding us that the biodiversity we value emerged from millennia of human-forest interaction. Understanding this legacy is crucial not only for archaeology but for contemporary efforts to conserve and sustainably manage these cultural landscapes.\n\n## Appendix\n\nComparison of tile-level site counts from observed data and zero-shot results from a variety of GPT models.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nresults <- readRDS(here('data/derived/results.rds')) |>\n  mutate(.truth = lengths(st_intersects(geometry, anthrosols)),\n         centroids = lengths(st_intersects(geometry, st_centroid(anthrosols))),\n         agent = map_dbl(agent_results, ~.x$result$count)\n)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `centroids = lengths(st_intersects(geometry,\n  st_centroid(anthrosols)))`.\nCaused by warning:\n! st_centroid assumes attributes are constant over geometries\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nresults |>\n  select(-id, -.truth, -nano) |>\n  rename(.observed_sites = centroids) |>\n pivot_longer(-geometry) |>\nggplot() +\n  geom_sf(aes(fill = value)) +\n  facet_wrap(~name) +\n  scale_fill_viridis_c(name = 'Site count') +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-jats/unnamed-chunk-14-1.png)\n:::\n:::\n\n\n\n\n\nPerformance metrics for zero-shot site detection:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsite_detection_metrics <- metric_set(accuracy, sens, spec, f_meas)\n\nresults |>\n  select(-.truth) |>\n  st_drop_geometry() |>\n  pivot_longer(-c(id, centroids), names_to = 'model', values_to = 'estimate') |>\n  group_by(model) |>\n  mutate(estimate = factor(estimate > 0),\n         truth = factor(centroids > 0)) |>\n  site_detection_metrics(truth = truth, estimate = estimate, event_level = 'second') |>\n  select(-.estimator) |>\n  pivot_wider(names_from = .metric, values_from = .estimate) |>\n  mutate(across(where(is.numeric), ~ round(.x, 3))) %>%\n  arrange(desc(accuracy)) |>\n  kableExtra::kable()\n```\n\n::: {.cell-output-display}\n\n\n|model   | accuracy|  sens|  spec| f_meas|\n|:-------|--------:|-----:|-----:|------:|\n|o4_mini |    0.742| 0.672| 0.873|  0.773|\n|nano    |    0.681| 0.950| 0.175|  0.796|\n|agent   |    0.670| 0.613| 0.778|  0.709|\n|mini    |    0.654| 0.664| 0.635|  0.715|\n|gpt_4.1 |    0.637| 0.513| 0.873|  0.649|\n|o3      |    0.615| 0.454| 0.921|  0.607|\n\n\n\nPerformance metrics for automated zero-shot site detection.\n:::\n:::\n\n\n\n\n\nPerformance metrics for zero-shot site counting:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nregression_metrics <- metric_set(rmse, mae, rsq)\n\nresults |>\n  select(-.truth) |>\n  st_drop_geometry() |>\n  pivot_longer(-c(id, centroids), names_to = 'model', values_to = 'estimate') |>\n  group_by(model) |>\n  mutate(estimate = pmax(estimate, 1e-6)) |>\n  regression_metrics(truth = centroids, estimate = estimate) |>\n  select(-.estimator) |>\n  pivot_wider(names_from = .metric, values_from = .estimate) |>\n  mutate(across(where(is.numeric), ~ round(.x, 3))) %>%\n  arrange(rmse) |>\n  kableExtra::kable()\n```\n\n::: {.cell-output-display}\n\n\n|model   |  rmse|   mae|   rsq|\n|:-------|-----:|-----:|-----:|\n|agent   | 2.910| 1.852| 0.460|\n|o4_mini | 3.063| 1.901| 0.486|\n|mini    | 3.097| 2.143| 0.413|\n|gpt_4.1 | 3.331| 2.170| 0.458|\n|o3      | 3.637| 2.379| 0.404|\n|nano    | 3.813| 2.703| 0.072|\n\n\n\nPerformance metrics for automated zero-shot site counting.\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}